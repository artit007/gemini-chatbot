<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>LookerStudio Gemini Chatbot</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 2rem;
      background: #f4f4f4;
      max-width: 600px;
      margin: auto;
    }
    h2 {
      color: #2a5d84;
    }
    textarea {
      width: 100%;
      height: 100px;
      padding: 0.5rem;
      font-size: 1rem;
    }
    button {
      padding: 10px 20px;
      margin-top: 10px;
      font-size: 1rem;
      background: #2a5d84;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background: #1d4566;
    }
    pre {
      background: white;
      padding: 1rem;
      margin-top: 1rem;
      white-space: pre-wrap;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>

  <h2>üí¨ ‡∏â‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏ô‡πâ‡∏≠‡∏•‡∏î‡∏¥‡∏à‡∏¥ ‡∏ß‡∏±‡∏ô (Looker-Gemini)</h2>
  <p>‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô dashboard ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô:</p>
  <ul>
    <li>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÑ‡∏ï‡∏£‡∏°‡∏≤‡∏™ 3/2025 ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà?</li>
    <li>Top 3 sale ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡πÉ‡∏Ñ‡∏£‡∏ö‡πâ‡∏≤‡∏á?</li>
  </ul>

  <textarea id="question" placeholder="‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..."></textarea>
  <br />
  <button onclick="askGemini()">‡∏ñ‡∏≤‡∏°‡∏ô‡πâ‡∏≠‡∏•‡∏î‡∏¥‡∏à‡∏¥ ‡∏ß‡∏±‡∏ô</button>
  <pre id="answer">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏∞‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà...</pre>

  <script>
    const scriptUrl = "https://script.google.com/macros/s/AKfycbzWVaWAn-nAXWG837i5dJMDPyaGJuvX4G4iHntsKn2ZSdNeDKkNurh2SgyXeNSeLstMKA/exec"; // ‚Üê ‡πÉ‡∏™‡πà Web App URL ‡∏à‡∏≤‡∏Å Apps Script

    async function askGemini() {
      const question = document.getElementById("question").value.trim();
      if (!question) {
        document.getElementById("answer").textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡πà‡∏∞";
        return;
      }

      document.getElementById("answer").textContent = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ñ‡∏≤‡∏°‡∏ô‡πâ‡∏≠‡∏•‡∏î‡∏¥‡∏à‡∏¥ ‡∏ß‡∏±‡∏ô...";

      try {
        const res = await fetch(scriptUrl, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ prompt: question })
        });

        const text = await res.text();
        document.getElementById("answer").textContent = text;
      } catch (err) {
        document.getElementById("answer").textContent = "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + err.message;
      }
    }
  </script>
</body>
</html>
